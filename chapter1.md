# 介绍

*在这一章中, 我们介绍现代密度泛函理论的一些基本概念, 包括一个体系的Kohn-Sham描述, 并给出一些科研中简单有力的DFT实例*

## 1.1 重要性

密度泛函理论早已成为了凝聚态物理中电子结构计算的中流砥柱. 二十世纪九十年代, 在量子化学领域非常流行. 这是因为这种近似的泛函在精确和效率之间做了权衡, 在保证精确度的情况下, 可以计算比传统第一性原理能处理的更大的体系. 如今, 传统的波函数方法, 无论是变分的还是摄动的, 都可以在较小的系统上得到高精度的结果, 为密度泛函理论的发展提供了基准, 从而再将其应用大更大的体系上. 

但是密度泛函理论不是另一种求解薛定谔方程的方法, 也不是依托经验参数. 密度泛函理论是一种完全不同的, 形式严格的, 可以处理 *任何* 相互作用问题的方法. 它的思路是将相互作用问题 *精准* 地映射到易于求解的非相互作用问题上. 这个方法被广泛应用于不同的领域, 其中最常见的是基态电子结构问题. 

这本书希望以一种相对简单但又不失严格的方式来介绍这一理论. 在数学物理工具的使用上, 不会超过任何研究生的量子力学课程, 或者是高阶本科生课程, 但是在很多概念上却有极大的跨越. 这种跨越几乎和从经典力学到量子力学一样大. 从某种意义上说, 甚至更困难一些, 因为这种跨越通常是我们的思维更进一步的时候才会发生. 

来自各个计算科学领域的同学(化学, 物理, 地球物理, 材料学, 生物化学) 都可以学习这个材料, 只需要良好的量子力学基础, 不害怕超过一个变量的微积分, 和渴望学习的心. 最终同学们可以知道什么是Kohn-Sham方程, 什么是泛函, 多少知道一些它们的性质, 它们如何被近似的, 和理解这些工具在电子结构计算中所引入的误差. 

在完成这本书的5年中, 我的课堂讲义已经在全世界被使用, 希望这些笔记能被全世界的同学用来更好地理解这一基本理论. 如果你使用这个材料, 我只要求你发一封电子邮件(kieron@rutchem.rutgers.edu)给我, 我会很乐意解答你的问题. 这个笔记的版权属于Kieron Burke, 不得以销售为目的传播. 

这本书的形式是本科生教材, 需要同学们做很多的练习, 即便答案已经给出. 这本书的构想是应该非常容易阅读, 但是留给读者非常清晰的现代密度泛函理论的概念. 在学习这本书的过程中, 有些练习只有在做完之后才能领会到这本书的精髓. 同样在每一章结尾, 有很多的问题会领着你思考. 这些问题应该独自地思考和回答, 但是不必写出来. 

## 1.2 什么是Kohn-Sham计算?

为了搞清楚DFT是什么, 为什么这么重要, 我们从一个非常简单的例子开始--氢分子$H_2$. 整本书中我们都做了Born-Oppenheimer近似, 即, 将质量大的原子核当成固定的点, 只需要计算周围基态电子的量子力学问题.

在一般的量子力学中, 我们必须计算相互作用的薛定谔方程:

$$
\left\{-\frac{1}{2} \sum_{i=1,2} \nabla_{i}^{2}+\frac{1}{\left|\mathbf{r}_{1}-\mathbf{r}_{2}\right|}+\sum_{i=1,2} v_{\text {ext }}\left(\mathbf{r}_{i}\right)\right\} \Psi\left(\mathbf{r}_{1}, \mathbf{r}_{2}\right)=E \Psi\left(\mathbf{r}_{1}, \mathbf{r}_{2}\right) \tag{1.1}
$$

第一项是第$i$个粒子的动能算符, 第二项是两个电子间相互作用的位能, 第三项是每个电子对核的位能.

电子和核的相互作用而带来的外势:

$$
v_{\mathrm{ext}}(\mathbf{r})=-Z / r-Z /|\mathbf{r}-R \hat{\mathbf{z}}| \tag{1.2}
$$

其中$Z=1$是每个原子核的能量, $\hat{\mathbf{z}}$是沿着键方向的单位向量, $R$是核间的距离. 除非另有说明, 我们在本文中使用原子单位, 所以有:

$$
e^{2}=\hbar=m=1 \tag{1.3}
$$

其中$e$是电子电荷, $\hbar$是普朗克常数, $m$是电子质量. 因此, 能量都用Hartree($1H = 27.2114 eV = 627.5k cal/mol$), 距离都用玻尔半径($\alpha_o=0.529 Å$)表示. 在这个例子中, 电子处在自旋单线态, 所以空间波函数是$\Psi(\mathbf{r}_1, \mathbf{r}_2)$是交换电子后对称的. 这个薛定谔方程的解由于电子相互作用的引入而变得复杂, 我们用$V_{ee}$表示. 两组电子的坐标耦合在一起, 使其成为了一个有着6个坐标的偏微分方程, 精准解的求解相当地苛刻. 

![fig1.1](/assets/fig1-1.png)

上图中, 我们画出了分子总能量$E+1/R$, 第二项是核间的库伦排斥作用. 能量最小点是键平衡距离, 键能是最低点减去零点震动能. 更一般地说, 全局能量最小值决定了分子的所有几何结构, 或固体的晶格结构, 以及所有的振动和旋转. 但是对于有着$N$个电子的体系, 波函数依赖于$3N$个电子坐标. 


有了准确的基态波函数, 很容易计算系统的概率密度:

$$
n(\mathbf{r})=2 \int d^{3} r^{\prime}\left|\Psi\left(\mathbf{r}, \mathbf{r}^{\prime}\right)\right|^{2} \tag{1.4}
$$

概率密度给出了在$\mathbf{r}$周围$d^3r$范围内找到一个电子的概率是$n(\mathbf{r})d^3r$. 对于处在平衡状态的$H_2$分子, 这就像是两个熟悉的衰减指数, 其中心在原子核上, 核间由于分子键的形成而有一个增强. 

> 这个概率密度函数的图形是什么样的?

接下来, 想象一个有着两个*无*相互作用电子的体系, 只有和原子核相互作用的势$v_{\mathrm{s}}(\mathbf{r})$用来模仿真实电子体系. 因为电子之间没有相互作用, 因此它们的坐标解耦, 波函数可以简单地看作单电子波函数的乘积, 称之为*轨道*. 它满足:

$$
\left\{-\frac{1}{2} \nabla^{2}+v_{\mathrm{s}}(\mathbf{r})\right\} \phi_{i}(\mathbf{r})=\epsilon_{i} \phi_{i}(\mathbf{r}) \tag{1.5}
$$

其中$\Phi\left(\mathbf{r}_{1}, \mathbf{r}_{2}\right)=\phi_{0}\left(\mathbf{r}_{1}\right) \phi_{0}\left(\mathbf{r}_{2}\right)$, 这方程组解起来就非常容易, 因为只有三个坐标. 即使有$N$个电子, 仍然只需要求解一个3维方程, 且只占据了前$N/2$个能级, 而不是解一个$3N$坐标的薛定谔方程. 

> 为什么只占有N/2个能级?

如果能够让我们的无相互作用体系和真实系统足够地相似, 那么就转化为一个在计算上可解的问题.

我们如何去做到这种相似呢? 传统上, 我们将真实的波函数近似为非相互作用轨道的乘积, 然后最小化这个函数的能量, 从Hartree-Fock方程可以得到一个有效的势:

$$
v_{\mathrm{S}}^{\mathrm{HF}}(\mathbf{r})=v_{\mathrm{ext}}(\mathbf{r})+\frac{1}{2} \int d^{3} r^{\prime} \frac{n\left(\mathbf{r}^{\prime}\right)}{\left|\mathbf{r}-\mathbf{r}^{\prime}\right|} \tag{1.6}
$$

这个修正的外势播模仿除了第二个电子的作用, 特别是对核的屏蔽. 举例来说, 距离分子很远的地方, 势能衰减到$-1/r$, 表现出的有效电荷为$Z-1$. 将这个势带回`eq(1.5)`, 得到仅依赖于电子密度的势, 这又是从方程的解中得出的方程. 因此, 称这组方程是自洽的. 对于这个势, 会有一个起始的猜测, 再解特征值问题, 计算密度, 得到新的势. 迭代这个过程, 直到不再有变换, 达到自洽. 这一组方程通常被称为自洽场方程. `fig1.1`中, 我们画出了Hartree-Fork的结果, 发现, 即便是最小值的位置非常地准确, 却显著降低了分子的能量. 这是这种方法最明显的不足, 传统做法是通过改进波函数以得到更好的能量. 缺失的能量被称为交换能. 

在Kohn-Sham计算中, 基本的步骤非常相似, 但是逻辑上却大大不同. 想象一对无相互作用的电子, 它们的密度$n(\mathbf{r})$和这个物理体系完全相同. 这就是Kohn-Sham体系. 如果已知依赖于密度的总能量$E$ 使用密度泛函方法可以推导出它的势能$v_{\mathrm{S}}(\mathbf{r})$. 对于所有的电子系统, 都可以用一个简单的近似来表示未知的能量对密度依赖关系, 并且可以预测虚拟出的非相互作用电子的能量和自洽势. 从这个角度看, 轨道的Kohn-Sham波函数不能被看作是精确波函数的近似, 而是任意一个电子体系中被精确定义的一种属性, 这种属性只取决于密度. 为了理解这一点, 以我们的$H_2$为例, 极限情况下就是联合原子$He$. `fig1.2`中, $He$原子的多体波函数可以被非常精确地计算出来, 并得到了密度. 在这个图的下方, 我们画出了物理外势$-2/r$, 和精确的Kohn-Sham势. 两个*无*相互作用电子在这个势中的密度与相互作用电子的密度完全相同. 

如果我们可以找到精准近似这个势的方法, 我们就可以得到比真实体系容易求解的方程. 因此, 我们一直试图改进非相互作用波函数的非相互作用计算, 而不是求解整个物理体系. `fig1.1`中, 同样绘出了局域密度近似(Local Density Approximation, LDA)和广义梯度近似(generalized gradient approximation, GGA)的曲线. LDA是最简单的密度泛函近似, 它已经大大改进了HF, 尽管它通常比$1H$高出约1/20(1 eV 或者 30 kcal/mol), 这对于大多数量子化学工作来说太不准确了, 但是对于许多固态计算来说足够可靠. 

更复杂的GGA(及其混合方法)将LDA中的典型误差降低了约5倍或更多, 使DFT成为量子化学中非常有用的工具. 在1.5节中, 我们用一个简单的量子力学例子来说明密度泛函是如何工作的. 